!function(W){var WD=W.document,WDL=WD.location,i,j,l,JMVC=W.JMVC=(function(){var $JMVC,JMVC_VERSION=1.9,JMVC_REVIEW=4,JMVC_PACKED=false,jmvc={},US="/",DEV_URL=WDL.protocol+US+US+"www.jmvc.dev",PROD_URL=WDL.protocol+US+US+"www.jmvc.org",PATH={ext:US+"app"+US+"extensions"+US,test:US+"app"+US+"test"+US,lang:US+"app"+US+"i18n"+US},URL_ALLOWED_EXTENSIONS=["html","htm","jsp","php","js","jmvc","j","mvc","fg"],JMVC_DEFAULT={controller:"index",action:"index"},dispatched,Controller,Model,View,Interface,Parser,Event,Promise,Modules=["google/analytics","cookie"],hooks={},langs={},time_begin=+new Date(),undef="undefined",noop=function(){},getmode="ajax";jmvc={expose:function(o,hard){hard=!!hard;$JMVC.each(o,function(el,i){W[i]=hard?el:W[i]||el})},"eval":function(r){W.eval(r)},basic_inherit:function(Child,Parent){function T(){}T.prototype=Parent.prototype;Child.prototype=new T();Child.prototype.constructor=Child;Child.superClass=Parent.prototype;Child.baseConstructor=Parent},model_inherit:function(m){m.prototype.get=Model.prototype.get;m.prototype.set=Model.prototype.set;m.prototype.del=Model.prototype.del;m.prototype.vars=Model.prototype.vars;m.prototype.reset=Model.prototype.reset;m.prototype.constructor=Model.prototype.constructor},extend:function(label,obj,reqs){var trg=jmvc.ns.make("JMVC."+label),proceed=true;if(typeof obj.initCheck==="function"){proceed=obj.initCheck.call($JMVC)}if(!proceed){return false}(function(t,o){var j;for(j in o){if(o.hasOwnProperty(j)&&typeof t[j]==="undefined"){t[j]=o[j]}}})(trg,obj);if(typeof trg.init==="function"){trg.init.call($JMVC);delete trg.init}},check_hook:function(hookname,param){var orig=param,dyn=param[0];if(hooks[hookname]){jmvc.each(hooks[hookname],function(f){dyn=f.apply(null,[dyn])})}return dyn},xhrget:function(path,type,name,params){var ret=false,o;if(type==="view"&&typeof $JMVC.views[name]==="function"){ret=$JMVC.views[name]}else{if(type==="model"&&typeof $JMVC.models[name]==="function"){o=new $JMVC.models[name]();o.vars={};ret=o}else{$JMVC.io.get(path,function cback(res){switch(type){case"view":$JMVC.views[name]=new View(res);ret=$JMVC.views[name];break;case"controller":jmvc.eval(res);jmvc.basic_inherit($JMVC[type+"s"][name],Controller);break;case"model":jmvc.eval(res);jmvc.model_inherit($JMVC[type+"s"][name]);o=new $JMVC.models[name]();if(params){$JMVC.models[name].apply(o,params)}o.vars={};ret=o;break;case"interface":if(!JMVC.interfaces[name]){jmvc.eval(res)}break}},false)}}return ret},factory_method:function(type,name,params){var pieces=name.split("/"),path=false,path_absolute=$JMVC.vars.baseurl+US+"app"+US+type+"s/",ret;if(pieces.length>1){name=pieces.pop();path=pieces.join(US)}if(type==="controller"){path_absolute+=$JMVC.c_prepath}path_absolute+=(path?path+US:"")+name;switch(type){case"view":path_absolute+=".html";break;case"model":case"controller":path_absolute+=".js";break;case"interface":path_absolute+=".interfaces.js";break;default:type=false;break}if(!type){return false}ret=jmvc.xhrget(path_absolute,type,name,params);return ret},render:function(cback){var ctrl,i;$JMVC.factory("controller",$JMVC.c);if($JMVC.controllers[$JMVC.c]){jmvc.basic_inherit($JMVC.controllers[$JMVC.c],Controller);ctrl=new $JMVC.controllers[$JMVC.c]();$JMVC.controllers[$JMVC.c]=ctrl;if(ctrl.jmvc_routes){$JMVC.a=ctrl.jmvc_routes[$JMVC.a]||$JMVC.a}for(i in $JMVC.p){if($JMVC.p.hasOwnProperty(i)){ctrl.set(i,decodeURI($JMVC.p[i]))}}if(ctrl[$JMVC.a]&&typeof ctrl[$JMVC.a]==="function"){ctrl[$JMVC.a]()}else{if($JMVC.a.toLowerCase()!==JMVC_DEFAULT.action){WDL.href=US+"404"+US+"msg"+US+"act"+US+$JMVC.a}}}else{if($JMVC.c.toLowerCase()!==JMVC_DEFAULT.controller){WDL.href=US+"404"+US+"msg"+US+"cnt"+US+$JMVC.c}}if(cback&&typeof cback==="function"){cback.call($JMVC)}$JMVC.loaded=true},set:function(name,content){$JMVC.vars[name]=content},get:function(name){return $JMVC.vars[name]||""},del:function(name){$JMVC.vars[name]&&(delete $JMVC.vars[name])},bind_old:function(func,ctx){return function(){return func.apply(ctx,arguments)}},bind:function(func,ctx){var args=Array.prototype.slice.call(arguments,2);return function(){func.apply(ctx||$JMVC,[].concat(args,Array.prototype.slice.call(arguments)))}},require:function(){var i=0,l=arguments.length,curr=-1,isTest=false,path,head=JMVC.WD.getElementsByTagName("head").item(0),s;for(null;i<l;i+=1){if(typeof arguments[i]==="string"&&!$JMVC.extensions[arguments[i]]){curr+=1;isTest=arguments[i]==="test";path=PATH[isTest?"test":"ext"]+arguments[i]+".js";switch(getmode){case"ajax":$JMVC.io.get(path,function(jres){jmvc.eval(jres)},false);break;case"script":s=JMVC.WD.createElement("script");s.src=path;head.appendChild(s);break}$JMVC.extensions[arguments[i]]=arguments[i]}}},globalize:function(obj,name){JMVC.W[name]=obj},lang:function(){var lng=Array.prototype.slice.call(arguments,0),i=0,l=lng.length;while(i<l){if(!langs[lng[i]]){$JMVC.io.get(PATH.lang+lng[i]+".js",function(ln){jmvc.eval(ln)},false);langs[lng[i]]=true}i+=1}},hook:function(obj,force){var allowed=["onBeforeRender","onAfterRender","onBeforeParse","onAfterParse"],f=0;for(f in obj){if(obj.hasOwnProperty(f)){try{if($JMVC.util.inArray(allowed,f)>-1||force){hooks[f] instanceof Array||(hooks[f]=[]);hooks[f].push(obj[f])}else{throw {message:'EXCEPTION : You`re trying to hook unallowed function "'+f+'"'}}}catch(e){W.alert(e.message)}}}},ns:{make:function(str,obj,ctx){var chr=".",els=str.split(chr),u="undefined",ret;(typeof ctx===u)&&(ctx=W);(typeof obj===u)&&(obj={});if(!ctx[els[0]]){ctx[els[0]]=(els.length===1)?obj:{}}ret=ctx[els[0]];return(els.length>1)?jmvc.ns.make(els.slice(1).join(chr),obj,ctx[els[0]]):ret},check:function(ns,ctx){var els=ns.split("."),i=0,l=els.length;ctx=(ctx!=undefined)?ctx:W;for(null;i<l;i+=1){if(ctx[els[i]]){ctx=ctx[els[i]]}else{return false}}return ctx},},purge:function(o){var a=o.attributes,i,l,n;if(a){for(i=0,l=a.length;i<l;i+=1){n=a[i].name;if(typeof o[n]==="function"){o[n]=null}}}a=o.childNodes;if(a){for(i=0,l=a.length;i<l;i+=1){jmvc.purge(o.childNodes[i])}}},prototipize:function(el,obj){var p;for(p in obj){if(obj.hasOwnProperty(p)){el.prototype[p]=obj[p]}}},debug:function(){try{W.console.log.apply(W.console,arguments)}catch(e1){try{W.opera.postError.apply(W.opera,arguments)}catch(e2){W.alert(Array.prototype.join.call(arguments," "))}}},htmlspecialchars:function(text){return text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},each:function(o,func){var i,l,ret,t,type;type=({}).toString.call(o).match(/\s([a-zA-Z]+)/)[1].toLowerCase();func._break=false;func._continue=false;func["break"]=func.exit=function(){func._break=true};func["continue"]=func.skip=function(){func._continue=true};return type.match(/(array|object)/)?{object:function(){var x;ret={};for(i in o){func._continue=false;x=func.call(o,o[i],i);if(func._continue){continue}if(func._break){break}ret[i]=x}return ret},array:function(){var x;i=0;l=o.length;ret=[];for(;i<l;i+=1){func._continue=false;x=func.call(o,o[i],i);if(func._continue){continue}if(func._break){break}ret.push(x)}return ret}}[type]():false},promise:{create:function(){return new Promise()},join:function(){},chain:function(){}},parselang:function(cnt){var RXlng="\\[L\\[([\\S\\s]*?)\\]([A-z]*?)\\]",lang=true,defaultlang="en",tmp,limit=100000,cookie_lang=$JMVC.p.lang||$JMVC.cookie.get("lang");if($JMVC.p.lang){$JMVC.cookie.set("lang",$JMVC.p.lang)}$JMVC.i18n||($JMVC.i18n={});while(limit){lang=new RegExp(RXlng,"gm").exec(cnt),tmp="";if(!!lang){!lang[2]&&(lang[2]=cookie_lang||defaultlang);tmp=lang[2]&&$JMVC.i18n[lang[2]]&&$JMVC.i18n[lang[2]][lang[1]]?$JMVC.i18n[lang[2]][lang[1]]:lang[1];cnt=cnt.replace(lang[0],tmp)}else{break}lang=!!lang;limit-=1}return cnt}};Parser={tpl:function(content){return(content.match(/\<%/))?(function(str){var fn=new Function("obj","var p=[]; p.push('"+str.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');  return p.join('');");return fn(str)})(content):content},parse:function(content){var cont=content,RX={patt:"{{(.[^\\}]*)}}",pattpar:"\\s(.[A-z]*)=`(.[^/`]*)`",pattvar:"\\$(.[^\\$\\s}]*)\\$",viewname:"^(.[A-z]*)\\s"},res,myview,tmp1,tmp2,i=0,j,k,limit=100,viewname,orig,register,go_ahead=true;while(i<limit){i+=1;res=new RegExp(RX.patt,"gm").exec(cont);if(res){viewname=orig=res[1];register=false;if(new RegExp(RX.pattpar,"gm").test(res[1])){register={};tmp2=(new RegExp(RX.viewname)).exec(res[1]);viewname=tmp2[1];tmp2=res[1];while(go_ahead){tmp1=(new RegExp(RX.pattpar,"gm")).exec(tmp2);if(tmp1){register[tmp1[1]]=tmp1[2];tmp2=tmp2.replace(" "+tmp1[1]+"=`"+tmp1[2]+"`","")}else{go_ahead=false}}}if(!$JMVC.views[viewname]){myview=$JMVC.factory("view",viewname)}else{myview=$JMVC.views[viewname]}if(register!==false){for(k in register){if(register.hasOwnProperty(k)){myview.set(k,register[k])}}}tmp1=true;while(tmp1){tmp1=new RegExp(RX.pattvar,"gm").exec(myview.content);if(tmp1){myview.content=myview.content.replace("$"+tmp1[1]+"$",myview.get(tmp1[1]))}}cont=cont.replace("{{"+orig+"}}",myview.content)}}for(j in $JMVC.vars){if($JMVC.vars.hasOwnProperty(j)){cont=cont.replace(new RegExp("\\$"+j+"\\$","g"),$JMVC.vars[j])}}cont=Parser.tpl(cont);jmvc.check_hook("onAfterParse",[cont]);return cont}};Event=function(sender){this.sender=sender;this.listeners=[]};Event.prototype={attach:function(listener){this.listeners.push(listener)},notify:function(args){var i,l;for(i=0,l=this.listeners.length;i<l;i+=1){this.listeners[i](this.sender,args)}}};Promise=function(){this.cbacks=[];this.len=0;this.completed=false;this.res=false;this.err=false;this.reset=function(){this.len=0;this.cbacks=[]}};Promise.prototype.done=function(res,err){var i=0;this.completed=true;this.res=res;this.err=err;for(null;i<this.len;i+=1){this.cbacks[i](res,err)}this.reset()};Promise.prototype.then=function(cback,ctx){var func=jmvc.bind(cback,ctx);if(this.completed){func(this.res,this.err)}else{this.cbacks[this.len]=func;this.len+=1}return this};Interface=function(f){this.mthds=f};Interface.prototype.addMethod=function(mthd){this.mthds[mthd.name]||(this.mthds[mthd.name]=mthd)};Interface.prototype.removeMethod=function(mthd){this.mthds[mthd]&&(delete this.mthds[mthd])};Interface.prototype.check=function(o){var m,i=0,l=this.mthds.length,obj=new o();for(m in this.mthds){if(typeof obj[this.mthds[m]]!=="function"){return false}}obj=null;return true};Controller=function(){};Controller.prototype.vars={};Controller.prototype.jmvc_routes={};Controller.prototype.index=function(){W.alert("Default index action")};Controller.prototype.addRoutes=function(name,val){var j;if(typeof name==="string"){this.jmvc_routes[name]=val}if(typeof name==="object"){for(j in name){if(name.hasOwnProperty(j)){this.addRoutes(j,name[j])}}}};Controller.prototype.relocate=function(uri,ms){W.setTimeout(function(){WDL.href=String(uri)},~~(1*ms)||0)};Controller.prototype.render=function(content,cback){if(typeof content==="function"){cback=content;content=false}var tmp_v=new View(content);tmp_v.render(typeof cback==="function"?{cback:cback}:null);return this};Controller.prototype.reset=function(){this.vars={};return this};Model=function(){};Model.prototype.vars={};Model.prototype.reset=function(){this.vars={};return this};Model.prototype.constructor="model";View=function(cnt){this.ocontent=cnt||"";this.content=cnt||"";this.vars={baseurl:$JMVC.vars.baseurl}};View.prototype.parse=function(obj){var j;if(obj){for(j in obj.vars){if(obj.vars.hasOwnProperty(j)){this.content=this.content.replace("$"+j+"$",obj.get(j))}}}for(j in $JMVC.vars){if($JMVC.vars.hasOwnProperty(j)){this.content=this.content.replace("$"+j+"$",$JMVC.vars[j])}}return this};View.prototype.reset=function(){this.content=this.ocontent;this.vars={};return this};View.prototype.set_from_url=function(vname,alt){this.set(String(vname),$JMVC.controllers[$JMVC.c].get(vname)||(alt||"unset"));return this};View.prototype.get_from_url=function(vname){return $JMVC.controllers[$JMVC.c].get(vname)||false};View.prototype.render=function(pars){$JMVC.events.startrender();var arg=pars||{},cback=arg.cback||false,argz=arg.argz||null,target=arg.target||false,that=this,cont=this.content,pattvar="\\$(.[^\\$\\s}]*)\\$",resvar,t,trg,may_trg;if(typeof pars=="function"){cback=pars}cont=Parser.parse(cont);resvar=1;while(resvar){resvar=new RegExp(pattvar,"gm").exec(cont);if(resvar){t=this.get(resvar[1])||"";cont=cont.replace("$"+resvar[1]+"$",t)}}this.content=cont;if(!$JMVC.loaded){$JMVC.events.bind(W,"load",function(){$JMVC.loaded=true;may_trg=target?$JMVC.dom.find(target):false;trg=may_trg||WD.body;$JMVC.vars.rendertime=+new Date()-time_begin;that.content=jmvc.check_hook("onBeforeRender",[that.content]);$JMVC.dom.html(trg,that.content);jmvc.check_hook("onAfterRender",[that.content]);cback&&cback.apply(this,!!argz?argz:[]);$JMVC.events.endrender()})}else{may_trg=target?$JMVC.dom.find(target):false;trg=may_trg||WD.body;$JMVC.dom.html(trg,that.content);cback&&cback.apply(this,!!argz?argz:[])}return this};View.prototype.get=Model.prototype.get=Controller.prototype.get=function(n){return(!!this.vars[n])?this.vars[n]:false};View.prototype.set=Model.prototype.set=Controller.prototype.set=function(vname,vval,force){var i;switch(typeof vname){case"string":if(!this.vars[vname]||force){this.vars[vname]=vval}break;case"object":for(i in vname){if(vname.hasOwnProperty(i)&&(!this.vars[i]||vval||force)){this.vars[i]=vname[i]}}break}return this};View.prototype.del=Model.prototype.del=Controller.prototype.del=function(n){if(!!this.vars[n]){this.vars[n]=null}return this};dispatched=(function(){var mid={url:WDL.protocol+US+US+WDL.hostname+WDL.pathname+WDL.search,proto:WDL.protocol,host:WDL.hostname,path:WDL.pathname,hash:WDL.search},els=mid.path.replace(new RegExp("\\."+URL_ALLOWED_EXTENSIONS.join("|\\."),"gm"),"").substr(1).split(US),controller=false,controller_prepath="",controller_prepath_parts=[],action=false,params={},lab_val,ret,i,src,len=0;if(WDL.hostname==="localhost"){els.shift()}controller=els.shift()||JMVC_DEFAULT.controller;if(!!controller.match(/_/)){controller_prepath_parts=controller.split("_");controller=controller_prepath_parts.pop();controller_prepath=controller_prepath_parts.join(US)+US}action=els.shift()||JMVC_DEFAULT.action;len=els.length;for(i=0;i+1<len;i+=2){params[els[i]]=els[i+1]}if(mid.hash!==""){els=mid.hash.substr(1).split("&");for(i=0,len=els.length;i<len;i+=1){lab_val=els[i].split("=");if(!params[lab_val[0]]){params[lab_val[0]]=lab_val[1]}}}ret={controller:controller.replace(/\//g,""),controller_prepath:controller_prepath,action:action.replace(/\//g,""),params:params,baseurl:WDL.protocol+US+US+WDL.hostname};return ret})();$JMVC={loaded:false,W:W,WD:WD,US:US,M:Math,c_prepath:dispatched.controller_prepath,c:dispatched.controller||JMVC_DEFAULT.controller,a:dispatched.action||JMVC_DEFAULT.action,p:dispatched.params||{},controllers:{},models:{},views:{},interfaces:{},vars:{baseurl:dispatched.baseurl,extensions:dispatched.baseurl+PATH.ext,devurl:DEV_URL,produrl:PROD_URL,version:JMVC_VERSION,review:JMVC_REVIEW,last_modified:WD.lastModified,rendertime:0,retina:W.devicePixelRatio>1},widget:{},extensions:{},extensions_params:{},modules:Modules,Event:Event,globalize:jmvc.globalize,"interface":Interface,promise:jmvc.promise,parselang:jmvc.parselang,checkhook:jmvc.check_hook,bind:jmvc.bind,debug:jmvc.debug,extend:jmvc.extend,expose:jmvc.expose,factory:jmvc.factory_method,inherit:jmvc.basic_inherit,makeNS:jmvc.ns.make,checkNS:jmvc.ns.check,hook:jmvc.hook,hooks:hooks,jeval:jmvc.eval,prototipize:jmvc.prototipize,purge:jmvc.purge,parse:Parser.parse,render:jmvc.render,require:jmvc.require,lang:jmvc.lang,i18n:{},set:jmvc.set,get:jmvc.get,del:jmvc.del,htmlspecialchars:jmvc.htmlspecialchars,gc:function(){var i=0,a=arguments,l=a.length;for(null;i<l;i+=1){a[i]=null}},getView:function(n){return jmvc.factory_method("view",n)},getModel:function(n,params){return jmvc.factory_method("model",n,params)},loadInterfaces:function(n,params){return jmvc.factory_method("interface",n,params)},getNum:function(str){return parseInt(str,10)},getFloat:function(str){return parseFloat(str,10)},pFloat:function(f){return 1*f},pInt:function(i){return i>>0},mRound:function(n){return(n+0.5)>>0},mFloor:function(n){(n>0?n:n+1)>>0},mCeil:function(n){return(n+(n>0&&!!(n%1)))>>0},num:function(n){return parseFloat(n.toFixed(10),10)},noop:function(){return noop},each:jmvc.each,console:function(){if(!("console" in $JMVC.extensions)){$JMVC.require("core/console/console")}}};$JMVC.gc(DEV_URL,PROD_URL,URL_ALLOWED_EXTENSIONS,JMVC_VERSION,JMVC_REVIEW,dispatched,Controller,Model,View,Event,Modules,JMVC_DEFAULT,time_begin);return $JMVC})();JMVC.io={xhrcount:0,getxhr:function(){JMVC.io.xhrcount+=1;var xhr,IEfuckIds=["Msxml2.XMLHTTP","Msxml3.XMLHTTP","Microsoft.XMLHTTP"],i=0,len=IEfuckIds.length;try{xhr=new W.XMLHttpRequest()}catch(e1){for(null;i<len;i+=1){try{xhr=new W.ActiveXObject(IEfuckIds[i])}catch(e2){JMVC.debug("No way to initialize hxr")}}}JMVC.gc(IEfuckIds,i,len);return xhr},ajcall:function(uri,options){var xhr=JMVC.io.getxhr(),method=(options&&options.method)||"POST",cback=options&&options.cback,cb_opened=(options&&options.opened)||function(){},cb_loading=(options&&options.loading)||function(){},cb_error=(options&&options.error)||function(){},cb_abort=(options&&options.error)||function(){},sync=options&&options.sync,data=(options&&options.data)||{},type=(options&&options.type)||"text/html",cache=(options&&options.cache!==undefined)?options.cache:true,targetType=type==="xml"?"responseXML":"responseText",timeout=options&&options.timeout||3000,complete=false,res=false,ret=false,state=false;if(!cache){data.C=JMVC.util.now()}data=JMVC.util.obj2qs(data).substr(1);xhr.onreadystatechange=function(){var tmp;if(state===xhr.readyState){return false}state=xhr.readyState;if(xhr.readyState==="complete"||(xhr.readyState===4&&xhr.status===200)){complete=true;if(cback){res=xhr[targetType];(function(){cback(res)})(res)}ret=xhr[targetType];W.setTimeout(function(){JMVC.io.xhrcount-=1;JMVC.purge(xhr)},50);return ret}else{if(xhr.readyState===3){cb_loading()}else{if(xhr.readyState===2){cb_opened()}else{if(xhr.readyState===1){switch(method){case"POST":try{xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.send(data||true)}catch(e1){}break;case"GET":try{tmp={xml:"text/xml",html:"text/html",json:"application/json"}[type];xhr.setRequestHeader("Accept",tmp+"; charset=utf-8");xhr.send(null)}catch(e2){}break}}}}}};xhr.onerror=function(){if(cb_error){cb_error.apply(null,arguments)}};xhr.onabort=function(){if(cb_abort){cb_abort.apply(null,arguments)}};xhr.open(method,(method==="GET")?(uri+((data)?"?"+data:"")):uri,sync);W.setTimeout(function(){if(!complete){complete=true;xhr.abort()}},timeout);try{return(targetType==="responseXML")?xhr[targetType].childNodes[0]:xhr[targetType]}catch(e3){}},post:function(uri,cback,sync,data,cache){return JMVC.io.ajcall(uri,{cback:cback,method:"POST",sync:sync,data:data,cache:cache})},get:function(uri,cback,sync,data,cache){return JMVC.io.ajcall(uri,{cback:cback,method:"GET",sync:sync,data:data,cache:cache})},getJson:function(uri,cback,data){var r=JMVC.io.ajcall(uri,{type:"json",sync:false,cback:cback,data:data});return(W.JSON&&W.JSON.parse)?JSON.parse(r):JMVC.jeval("("+r+")")},getXML:function(uri,cback){return JMVC.io.ajcall(uri,{method:"GET",sync:false,type:"xml",cback:cback||function(){}})}};JMVC.util={objCompare:function(obj1,obj2,ret,i){(ret==undefined)&&(ret=true);if(!ret){return 0}if(obj1+""!=obj2+""){return false}for(i in obj1){ret=ret&&obj2[i]&&JMVC.util.objCompare(obj1[i],obj2[i],ret);if(!ret){return false}}for(i in obj2){ret=ret&&obj1[i]&&JMVC.util.objCompare(obj2[i],obj1[i],ret);if(!ret){return false}}return ret},objJCompare:function(obj1,obj2){return JSON.stringify(obj1)===JSON.stringify(obj2)},clone:function(obj){var temp,key;if(obj===null||typeof obj!=="object"){return obj}temp=obj.constructor();for(key in obj){if(obj.hasOwnProperty(key)){temp[key]=this.clone(obj[key])}}return temp},extend:function(obj,ext){var j;for(j in ext){if(ext.hasOwnProperty(j)){obj[j]=ext[j]}}},htmlEntities:function(html){return html.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&(?![\w\#]+;)/g,"&amp;")},denyiXrame:function(){if(W.top!==W.self){W.top.location=JMVC.vars.baseurl}},isSet:function(e){return typeof e!=="undefined"},defined:function(e){return typeof e!=="undefined"},coll2array:function(coll){var i=0,a=[],len=coll.length;for(null;i<len;i+=1){a[i]=coll[i]}return a},inArray:function(arr,myvar){var r=-1;JMVC.each(arr,function f(e,i){if(e===myvar){r=i;f["break"]()}});return r;var i=0,len=arr.length;for(null;i<len;i+=1){if(myvar===arr[i]){return i}}return -1},inArrayRich:function(arr,v){var i=0,is_obj_or_array=false,len=arr.length;for(null;i<len;i+=1){is_obj_or_array={}.toString.call(arr[i]).match(/\[object\s(Array|Object)\]/);if((is_obj_or_array&&JSON.stringify(arr[i])===JSON.stringify(v))||(!is_obj_or_array&&arr[i].toString()===v.toString())){return i}}return -1},in_object:function(obj,field){return(typeof obj==="object"&&obj[field])},isArray:function(o){var t1=String(o)!==o,t2={}.toString.call(o).match(/\[object\sArray\]/);return t1&&!!(t2&&t2.length)},isObject:function(o){var t1=String(o)!==o,t2={}.toString.call(o).match(/\[object\sObject\]/);return t1&&!!(t2&&t2.length)},isTypeOf:function(el,type){return typeof el===type},getType:function(o){return({}).toString.call(o).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},padme:function(val,el,pos,lngt){var len=lngt||2;while((String(val)).length<len){switch(pos){case"pre":val=String(el+val);break;case"post":val=String(val+el);break}}return val},rand:function(min,max){return min+~~(JMVC.M.random()*(max-min+1))},replaceall:function(tpl,o,dD,Dd,fback){dD||(dD="%");Dd||(Dd="%");var reg=new RegExp(dD+"([A-z0-9-_]*)"+Dd,"g"),str;return tpl.replace(reg,function(str,$1){return(typeof o==="function"?o($1):o[$1])||fback||dD+$1+Dd})},multireplace:function(cnt,o){JMVC.each(o,function(el,rx){cnt=cnt.replace(rx,el)});return cnt},str_repeat:function(str,n){var t=[];while(n-=1){t.push(str.replace(/\%n\%/g,n))}return t.reverse().join("")},obj2attr:function(o){var ret="",i;for(i in o){if(o.hasOwnProperty(i)){ret+=" "+i+(o[i]?'="'+o[i]+'"':"")}}return ret},obj2css:function(o){var ret="",i,j;for(i in o){if(o.hasOwnProperty(i)){ret+=i+"{";for(j in o[i]){if(o[i].hasOwnProperty(j)){ret+=j+":"+o[i][j]+";"}}ret+="} "}}return ret},obj2qs:function(o){var ret="",i;for(i in o){if(o.hasOwnProperty(i)){ret+=String((ret?"&":"?")+i+"="+encodeURIComponent(o[i]))}}return ret},rad2deg:function(r){return 180*r/JMVC.M.PI},deg2rad:function(d){return JMVC.M.PI*d/180},reload:function(){var n=JMVC.WD.location.href;WD.location.href=n},now:function(){return +new Date()},array_clone:function(arr){return arr.concat()},range:function(start,end){var ret=[];while(end-start+1){ret.push((start+=1)-1)}return ret},between:function(d,start,end,strict){return strict?(d>=start&&d<=end):(d>start&&d<end)},implement:function(o,interf,s){var i=0,l=interf.length,strict=true;if(typeof s!==undefined){strict=s}for(null;i<l;i+=1){if(!((o.prototype&&o.prototype[interf[i]]&&typeof o.prototype[interf[i]]==="function")||(!strict&&(o[interf[i]]&&typeof o[interf[i]]==="function")))){return false}}return true},str2code:function(str,pwd){var out=[],i=0,l=str.length;for(null;i<l;i+=1){out.push(str.charCodeAt(i))}return out},code2str:function(code,pwd){return String.fromCharCode.apply(null,code)},getParameters:function(scriptname){var scripts=WD.getElementsByTagName("script"),cs=null,src="",pattern=scriptname,p="",parameters=false,i=0,l=scripts.length;for(null;i<l;i+=1){cs=scripts[i];src=cs.src;if(src.indexOf(pattern)>=0){p=cs.getAttribute("params");parameters=p?eval("("+p+")"):{}}}return parameters},trim:function(s){return s.replace(/^\s+|\s+$/g,"")},ltrim:function(s){return s.replace(/^\s+/g,"")},rtrim:function(s){return s.replace(/\s+$/g,"")},hex2int:function(hex){return parseInt(hex,16)},int2hex:function(i){return parseInt(i,10).toString(16)}};JMVC.dom={body:function(){return WD.body},append:function(where,what){if(JMVC.util.isArray(what)){JMVC.each(what,function(e){where.appendChild(e)})}else{where.appendChild(what)}return where},addClass:function(elem,addingClass){var cls=!!(elem.className)?elem.className.split(" "):[];if(JMVC.util.inArray(cls,addingClass)<0){cls.push(addingClass);elem.className=cls.join(" ")}},attr:function(elem,name,value){var attrs=false,l=false,i=0,result,is_obj=false;try{elem.nodeType}catch(e){return false}if(elem.nodeType===3||elem.nodeType===8){return"undefined"}is_obj=JMVC.util.isObject(name);if(is_obj&&elem.setAttribute){for(i in name){elem.setAttribute(i,name[i])}return true}if(!name||name.constructor!==String){return""}if(typeof value!=="undefined"){elem[{"for":"htmlFor","class":"className"}[name]||name]=value;if(elem.setAttribute){elem.setAttribute(name,value)}}else{result=(elem.getAttribute&&elem.getAttribute(name))||0;if(!result){attrs=elem.attributes;l=attrs.length;for(i=0;i<l;i+=1){if(attrs[i].nodeName===name){return attrs[i].value}}}elem=result}return elem},clone:function(n,deep){return n.cloneNode(!!deep)},create:function(tag,attrs,inner){if(!tag){W.alert("no tag");return}var node=JMVC.WD.createElement(tag),att;attrs=attrs||{};for(att in attrs){if(attrs.hasOwnProperty(att)){node.setAttribute(String(att),String(attrs[att]))}}if(typeof inner!=="undefined"){if(inner.nodeType===1){this.append(node,inner)}else{this.html(node,inner)}}return node},createText:function(text){return JMVC.WD.createTextNode(text)},createNS:function(ns,name){return JMVC.WD.createElementNS(ns,name)},add:function(where,tag,attrs,inner){var n=this.create(tag,attrs,inner);this.append(where,n);return n},empty:function(el){el.innerHTML=""},find:function(a,b){if(a.nodeType===1){return a}var sel="getElement",toArr=false,ret=false;a=a.match(/^(\W)?([A-z0-9-_]*)/);switch(a[1]||"="){case"#":sel+="ById";break;case".":sel+="sByClassName";toArr=true;break;case"@":sel+="sByName";toArr=true;break;case"=":sel+="sByTagName";toArr=true;break;default:return[]}ret=(b||JMVC.WD)[sel](a[2]);ret=toArr?JMVC.util.coll2array(ret):ret;return ret instanceof Array?(ret.length==1?ret[0]:ret):ret},find2:function(a,b){if(a.nodeType===1){return a}var sel="getElement",toArr=0,ret=0;a=a.match(/^(\W)?([A-z0-9-_]*)/);a[1]=a[1]||"=";toArr=a[1]!=="#";ret=(b||JMVC.WD)[sel+({"#":"ById",".":"ByClassName","@":"sByName","=":"sByTagName"}[a[1]])](a[2]);ret=toArr?JMVC.util.coll2array(ret):ret;return ret instanceof Array?(ret.length==1?ret[0]:ret):ret},findInnerByClass:function(ctx,cname){var a=[],re=new RegExp("\\b"+cname+"\\b"),els=ctx.getElementsByTagName("*"),i=0,l=els.length;for(null;i<l;i+=1){if(re.test(els[i].className)){a.push(els[i])}}return a},findByAttribute:function(attr,value,root){var ret=[],whole=[],val,tof=value==undefined;root=root||JMVC.WD.body;whole=root.all?root.all:root.getElementsByTagName("*");for(var i=whole.length;i--;){val=whole[i].getAttribute(attr);if(typeof val=="string"&&(tof||val==value)){ret.push(whole[i])}}return ret},hasAttribute:function(el,name){return el.getAttribute(name)!==null},hasClass:function(el,classname){return el.className.match(new RegExp("(\\s|^)"+classname+"(\\s|$)"))},html:function(el,html){if(!el){return this}var t="";if(typeof html!=="undefined"){if(el){try{if(JMVC.dom.isElement(html)){JMVC.dom.empty(el);JMVC.dom.append(el,html)}else{el.innerHTML=String(html)}}catch(e){}}return this}else{t=(el.nodeType===1)?el.innerHTML:el}JMVC.purge(el);return t.trim()},isNode:function(o){return(typeof Node==="object"?o instanceof Node:o&&typeof o==="object"&&typeof o.nodeType==="number"&&typeof o.nodeName==="string")},isElement:function(o){return(typeof HTMLElement==="object"?o instanceof HTMLElement:o&&typeof o==="object"&&o.nodeType===1&&typeof o.nodeName==="string")},insertBefore:function(node,referenceNode){var p=referenceNode.parentNode;p.insertBefore(node,referenceNode);return node},insertAfter:function(node,referenceNode){var p=referenceNode.parentNode;p.insertBefore(node,referenceNode.nextSibling);return node},nthchild:function(node,num,types){var childs=node.childNodes,tagChilds=[],len=childs.length,i=0,type2consider=types||["TEXT_NODE"];while(len){if(JMVC.util.inArray(type2consider,this.nodeTypeString(childs[i]))){tagChilds.push(childs[i]);i+=1}len-=1}len=tagChilds.length;return(num<len)?tagChilds[num]:false},nodeTypeString:function(node){var types=["ELEMENT_NODE","ATTRIBUTE_NODE","TEXT_NODE","CDATA_SECTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","PROCESSING_INSTRUCTION_NODE","COMMENT_NODE","DOCUMENT_NODE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","NOTATION_NODE"];return types[node.nodeType-1]},preloadImage:function(src,fn){var i=new W.Image();typeof fn==="function"&&(i.onload=fn(i));i.src=src;return i},parent:function(node){return node.parentNode},prepend:function(where,what){var c=where.childNodes[0];where.insertBefore(what,c);return what},remove:function(el){if(!el){return}var parent;if(typeof el==="string"){el=JMVC.dom.find(el)}if(JMVC.util.isArray(el)){JMVC.each(el,function(e){JMVC.dom.remove(e)});return}parent=el.parentNode;parent.removeChild(el);return parent},removeAttribute:function(el,valore,mode){el.removeAttribute(valore);return el},removeClass:function(el,cls){var reg=new RegExp("(\\s|^)"+cls+"(\\s|$)");el.className=el.className.replace(reg,"");return this},switchClass:function(el,oldclass,newclass){if(this.hasClass(el,oldclass)){this.removeClass(el,oldclass);if(!this.hasClass(el,newclass)){this.addClass(el,newclass)}}return el},val:function(el){return el.value}};JMVC.events={bindings:{},onedone:false,Estart:[],Eend:[],bind:function(el,tipo,fn){if(el instanceof Array){JMVC.each(el,JMVC.events.bind,tipo,fn);return}if(W.addEventListener){el.addEventListener(tipo,fn,false)}else{if(W.attachEvent){var f=function(e){fn.call(el,e||W.event)};el.attachEvent("on"+tipo,f)}else{el["on"+tipo]=function(e){fn.call(el,e||W.event)}}}if(!JMVC.events.bindings[el]){JMVC.events.bindings[el]={}}JMVC.events.bindings[el][tipo]=fn},unbind:function(el,tipo){if(el===null){return}if(el.removeEventListener){el.removeEventListener(tipo,JMVC.events.bindings[el][tipo],false)}else{if(el.detachEvent){el.detachEvent("on"+tipo,JMVC.events.bindings[el][tipo])}}JMVC.events.bindings[el][tipo]=null},one:function(el,tipo,fn){if(el instanceof Array){JMVC.each(el,JMVC.events.one,tipo,fn);return}var newf=function(e){if(!this.onedone){fn(e)}this.onedone=true};JMVC.events.bind(el,tipo,newf)},kill:function(e){if(!e){e=W.event;e.cancelBubble=true;e.returnValue=false}if(e.stopPropagation){e.stopPropagation();e.preventDefault()}return false},ready:function(func){var e=null;if(WD.addEventListener){e=WD.addEventListener("DOMContentLoaded",func,false)}else{if(W.addEventListener){e=W.addEventListener("load",func,false)}else{if(WD.attachEvent){e=WD.attachEvent("onreadystatechange",func)}else{if(W.attachEvent){e=W.attachEvent("onload",func)}}}}return e},preventDefault:function(e){e=e||W.event;if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},eventTarget:function(e){var targetElement=(typeof e.target!=="undefined")?e.target:e.srcElement;while(targetElement.nodeType==3&&targetElement.parentNode!=null){targetElement=targetElement.parentNode}return targetElement},getCoord:function(el,e){var x,y;if(e.pageX||e.pageY){x=e.pageX;y=e.pageY}else{x=e.clientX+JMVC.WD.body.scrollLeft+JMVC.WD.documentElement.scrollLeft;y=e.clientY+JMVC.WD.body.scrollTop+JMVC.WD.documentElement.scrollTop}x-=el.offsetLeft;y-=el.offsetTop;return[x,y]},start:function(f){this.Estart.push(f)},end:function(f){this.Eend.push(f)},startrender:function(){var i=0,l=this.Estart.length;for(null;i<l;i+=1){this.Estart[i]()}},endrender:function(){var i=0,l=this.Eend.length;for(null;i<l;i+=1){this.Eend[i]()}},delay:function(f,t){W.setTimeout(f,t)},scrollBy:function(left,top){JMVC.events.delay(function(){W.scrollBy(left,top)},1)},scrollTo:function(left,top){JMVC.events.delay(function(){W.scrollTo(left,top)},1)},loadify:function(ms){JMVC.events.start(function(){JMVC.events.delay(function(){WD.body.style.opacity=0;WD.body.style.filter="alpha(opacity=0)"},0)});JMVC.events.end(function(){var i=0,step=0.05,top=1,to;while(i<=top){to=W.setTimeout(function(j){WD.body.style.opacity=j;WD.body.style.filter="alpha(opacity="+(j*100)+")";if(j>top){WD.body.style.opacity=1;WD.body.style.filter="alpha(opacity="+100+")";W.clearTimeout(to)}},ms*i,i+step);i+=step}})},touch:function(e){var touches=[],i=0,ect=e.touches,len=ect.length;for(null;i<len;i+=1){touches.push({x:ect[i].pageX,y:ect[i].pageY})}return touches}};JMVC.head={element:WD.getElementsByTagName("head").item(0),addscript:function(src,parse,explicit){var script,head,tmp,that=this,postmode=true,async=true,script_content;if(parse){if(explicit){script_content=JMVC.parse(src,true);script=JMVC.dom.create("script",{type:"text/javascript",defer:"defer"},script_content);head=that.element;head.appendChild(script)}else{tmp=JMVC.io.get(src,function(script_content){script_content=JMVC.parse(script_content,true);script=JMVC.dom.create("script",{type:"text/javascript",defer:"defer"},script_content);head=that.element;head.appendChild(script)},postmode,async)}}else{script=explicit?JMVC.dom.create("script",{type:"text/javascript",defer:"defer"},src):JMVC.dom.create("script",{type:"text/javascript",defer:"defer",src:src}," ");head=this.element;head.appendChild(script)}},addstyle:function(src,parse,explicit,id){var style,head,tmp,that=this,postmode=true,sync=false,rules,csscontent;if(parse){if(explicit){csscontent=JMVC.parse(src,true);head=that.element;style=WD.createElement("style");rules=WD.createTextNode(String(csscontent));style.type="text/css";if(style.styleSheet){style.styleSheet.cssText=rules.value}else{style.appendChild(rules)}if(id){style.id=id}head.appendChild(style)}else{tmp=JMVC.io.get(src,function(csscontent){csscontent=JMVC.parse(csscontent,true);head=that.element;style=WD.createElement("style");rules=WD.createTextNode(String(csscontent));style.type="text/css";if(style.styleSheet){style.styleSheet.cssText=rules.value||rules.nodeValue}else{style.appendChild(rules)}if(id){style.id=id}head.appendChild(style)},postmode,sync)}}else{style=JMVC.dom.create("link",{type:"text/css",rel:"stylesheet",href:src});head=this.element;head.appendChild(style)}return style},title:function(t){if(!t){return WD.title}WD.title=t;return true},meta:function(name,value){var meta=this.element.getElementsByTagName("meta"),newmeta=JMVC.dom.create("meta",{name:name,content:value}),len=meta.length;if(len){JMVC.dom.insertAfter(newmeta,meta.item(len-1))}else{this.element.appendChild(newmeta)}},link:function(rel,attrs){attrs.rel=rel;JMVC.dom.add(JMVC.head.element,"link",attrs)},lastmodified:function(d){var meta=this.element.getElementsByTagName("meta"),newmeta=JMVC.dom.create("meta",{"http-equiv":"last-modified",content:(d||new Date()).toString()}),len=meta.length;if(len){JMVC.dom.insertAfter(newmeta,meta.item(len-1))}else{this.element.appendChild(newmeta)}}};(function(){l=JMVC.modules.length;if(l>0){i=0;for(null;i<l;i+=1){JMVC.require(JMVC.modules[i])}}JMVC.render()})()}(this.window||global);JMVC.W.onerror=function(c,b,a){alert("Uncaught error "+c+" in "+b+", lines "+a)};